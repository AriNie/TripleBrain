---
layout: post
title: 東京海上日動コンテスト2020　C問題 # ページタイトル
tags: atcoder algorithm c++ # タグ
categories: atcoder # カテゴリ. AtCoderの解説記事は atcoder で.
---


* TOC
{:toc}

Author: Non　<!-- 自分の名前 -->

<!-- ↓↓↓↓↓ 記事内容 ↓↓↓↓↓ -->

# C問題　Lamps

<a href="https://atcoder.jp/contests/tokiomarine2020/tasks/tokiomarine2020_c" target="_blank">問題</a>



> ## 問題文
>数直線上に電球が 
N
 個並んでおり、電球には左から順に 
1
 から 
N
 までの番号がついています。 電球 
i
 は座標 
i
 にあります。
>
>電球には光の強さを表す非負整数値が定まっており、 座標 
x
 に光の強さ 
d
 の電球があるとき、その電球は座標 
x
−
d
−
0.5
 から座標 
x +     d  +
0.5
 までの区間を照らします。 初めは電球 
i
 の光の強さは 
A
i
 です。 そこで、以下の操作を 
K
 回繰り返し行います。
>
>1
 以上 
N
 以下の各整数 
i
 に対し、操作時に座標 
i
 を照らしている電球の個数を 
B
i
 とする。そして、各電球 
i
 の光の強さを 
B
i
 に変更する。
K
 回の操作を行った後の各電球の光の強さを求めてください。
>
> ## 制約
> - 1
≦
N
≦
2
×
10 ^ 
5
> - 1
≦
K
≦
2
×
10 ^ 
5
> - 0
≦
A
i
≦
N

<br>

## 方針

愚直にシミュレーションするとK回、各電球N個をたどることになるのでその計算量は`O(K * N)`すなわち、`O(10 ^ 10)`でとても間に合わない。

<br>

しかし、脳４でシミュレーションしていくとあることに気づく。

試しに最悪のシチュエーション（もっとも計算量がかかるシチュエーション）でシミュレーションをしてみる。

初期状態が

```
1, 0, 0, ... , 0
```

という場合である。

ここでわかりやすいようにどの電球がどの電球をてらしているかがわかりやすいように表にしてみる。表を追加すると初期状態は以下のようになる。

|電球のが照らしているかどうか＼電球の状態|1|0|0|0|0|0|0|0|0|0|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|0|0|0|0|0|0|0|0
電球２|0|1|0|0|0|0|0|0|0|0
電球３|0|0|1|0|0|0|0|0|0|0
電球４|0|0|0|1|0|0|0|0|0|0
電球５|0|0|0|0|1|0|0|0|0|0
電球６|0|0|0|0|0|1|0|0|0|0
電球７|0|0|0|0|0|0|1|0|0|0
電球８|0|0|0|0|0|0|0|1|0|0
電球９|0|0|0|0|0|0|0|0|1|0
電球10|0|0|0|0|0|0|0|0|0|1

<br>

１回目の操作が終了すると

|電球のが照らしているかどうか＼電球の状態|1|2|1|1|1|1|1|1|1|1|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|0|0|0|0|0|0|0|0
電球２|1|1|1|1|0|0|0|0|0|0
電球３|0|1|1|1|0|0|0|0|0|0
電球４|0|0|1|1|1|0|0|0|0|0
電球５|0|0|0|1|1|1|0|0|0|0
電球６|0|0|0|0|1|1|1|0|0|0
電球７|0|0|0|0|0|1|1|1|0|0
電球８|0|0|0|0|0|0|1|1|1|0
電球９|0|0|0|0|0|0|0|1|1|1
電球10|0|0|0|0|0|0|0|0|1|1

<br>

２回めの操作が終了すると

|電球のが照らしているかどうか＼電球の状態|2|3|3|3|3|3|3|3|3|2|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|1|0|0|0|0|0|0|0
電球２|1|1|1|1|1|0|0|0|0|0
電球３|1|1|1|1|1|1|0|0|0|0
電球４|1|1|1|1|1|1|1|0|0|0
電球５|0|1|1|1|1|1|1|1|0|0
電球６|0|0|1|1|1|1|1|1|1|0
電球７|0|0|0|1|1|1|1|1|1|1
電球８|0|0|0|0|1|1|1|1|1|1
電球９|0|0|0|0|0|1|1|1|1|1
電球10|0|0|0|0|0|0|1|1|1|1

<br>

３回目の操作が終了すると

|電球のが照らしているかどうか＼電球の状態|4|5|6|6|6|6|6|6|5|4|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|1|1|1|0|0|0|0|0
電球２|1|1|1|1|1|1|1|0|0|0
電球３|1|1|1|1|1|1|1|1|1|0
電球４|1|1|1|1|1|1|1|1|1|1
電球５|1|1|1|1|1|1|1|1|1|1
電球６|1|1|1|1|1|1|1|1|1|1
電球７|1|1|1|1|1|1|1|1|1|1
電球８|0|1|1|1|1|1|1|1|1|1
電球９|0|0|0|1|1|1|1|1|1|1
電球10|0|0|0|0|0|1|1|1|1|1

<br>

4回目の操作が終了すると

|電球のが照らしているかどうか＼電球の状態|7|8|8|9|9|9|9|8|8|7|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|1|1|1|1|1|1|0|0
電球２|1|1|1|1|1|1|1|1|1|1
電球３|1|1|1|1|1|1|1|1|1|1
電球４|1|1|1|1|1|1|1|1|1|1
電球５|1|1|1|1|1|1|1|1|1|1
電球６|1|1|1|1|1|1|1|1|1|1
電球７|1|1|1|1|1|1|1|1|1|1
電球８|1|1|1|1|1|1|1|1|1|1
電球９|1|1|1|1|1|1|1|1|1|1
電球10|0|0|1|1|1|1|1|1|1|1

<br>

5回目の操作が終了すると


|電球のが照らしているかどうか＼電球の状態|9|9|10|10|10|10|10|10|9|9|
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
電球１|1|1|1|1|1|1|1|1|1|1
電球２|1|1|1|1|1|1|1|1|1|1
電球３|1|1|1|1|1|1|1|1|1|1
電球４|1|1|1|1|1|1|1|1|1|1
電球５|1|1|1|1|1|1|1|1|1|1
電球６|1|1|1|1|1|1|1|1|1|1
電球７|1|1|1|1|1|1|1|1|1|1
電球８|1|1|1|1|1|1|1|1|1|1
電球９|1|1|1|1|1|1|1|1|1|1
電球10|1|1|1|1|1|1|1|1|1|1

<br>

６回目の操作が終了すると

```
10, 10, 10, 10, 10, 10, 10, 10, 10, 10
```
となりこれ以上操作しても各電球の光の強さは変わらなくなる。

この結果をみると指数爆発的に電球の強さが上がってきていることがわかる。

よって、　**N個の電球を操作する回数は高々`log(N)`**　である。

このことから計算量は`O(N * log(N))`でシミュレーションできそうである。

## コード（C++）

```cpp
#include<bits/stdc++.h>
using namespace std;
const int MAXN = 2e5 + 7;
int a[MAXN], b[MAXN];
int main() {
    int n, k; scanf("%d %d", &n, &k);
    for (int i = 1; i <= n; i++) scanf("%d", &a[i]);
    for (int step = 1, ok = 0; step <= k && !ok; step++) {
        for (int i = 1; i <= n; i++) b[i] = 0;
        for (int i = 1; i <= n; i++) {
            int l = max(1, i - a[i]), r = min(n, i + a[i]);
            b[l]++; b[r + 1]--;
        }
        int cnt = 0;
        for (int i = 1; i <= n; i++) {
            b[i] += b[i - 1], a[i] = b[i];
            if (a[i] == n) cnt++;  
        }
        if (cnt == n) ok = 1;
    }
    for (int i = 1; i <= n; i++) printf("%d%c", a[i], " \n"[i == n]);
    return 0;
}
```