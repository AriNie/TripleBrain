---
layout: post
title: AtCoder Beginner Contest 194 E問題 # ページタイトル
tags: atcoder algorithm python # タグ
categories: atcoder # カテゴリ. AtCoderの解説記事は atcoder で.
---


* TOC
{:toc}

Author: ののの　<!-- 自分の名前 -->

<!-- ↓↓↓↓↓ 記事内容 ↓↓↓↓↓ -->
本記事ではAtCoder Beginner Contest 194 E問題を解説していこうと思います。
# B問題 A^B^C

<a href="https://atcoder.jp/contests/abc194/tasks/abc194_e">E - Mex Min</a>

<br>

```
## 問題文
mex(x_1,x_2,x_3,…,x_k) を、x_1,x_2,x_3,…,x_k に含まれない最小の非負整数と定義します。 
長さNの整数列A=(A_1,A_2,A_3,…,A_N) が与えられます。
0≤i≤N−Mを満たす全ての整数iについてmex(A_(i+1),A_(i+2),A_(i+3),…,A_(i+M)) を計算したとき、
このN−M+1個の値のうちの最小値を求めてください。
```

```
##制約
* 1≦M≦N≦1.5*10^6
* 0≦A_i<N
* 入力に含まれる値は全て整数
```

```
##入力
N M
A_1 A_2 A_3...A_N
```

```
##出力
答えを出力せよ。
```

## 方針
最初に一言愚痴らせてください。1時間考えて解けなかった挙句、最初にこれだと時間足りなそうだなぁって却下したのが正解でした。皆さんも詰まったらダメもとでも通してみましょうと、私は言いたい。

さてさて、本題。

まず、説明のために$(A_{i+1},A_{i+2},A_{i+3},...,A_{i+M})$を部分数列と呼ぶことにする。この部分数列が1つずれたものを$(A_{i+2},A_{i+3},A_{i+4},...,A_{i+M+1})$としたときにこの2つの部分数列のmexの値の比較について考えたいと思う。

$mex_i=mex(A_{i+1},A_{i+2},A_{i+3},...,A_{i+M})$、$mex_{i+1}=mex(A_{i+2},A_{i+3},A_{i+4},...,A_{i+M+1})$としたとき、$mex_i=mex_{i+1}$が成り立つ時とそうでないときについて考える。
* 成り立たないときについて

  この時に考えられるのは$mex_i>A_{i+1}$かつ$A_{i+M+1}$追加後の部分数列に$A_{i+1}$と同じ値が要素として存在しないことである。
  
  例えば部分数列$i$が$(0,2,3,5)$の時、$mex_i=1$であるが、1つずれた部分数列$i+1$が$(2,3,5,4)$の時、$mex_{i+1}=0$となるのをイメージしてもらえば分かりやすいと思う。

* 成り立つとき

  上記を満たさないとき。例えば部分数列$i$が$(2,0,1,2)$の時、$mex_i=3$であるが、1つずれた部分数列$i+1$が$(0,1,2,1)$の時、$mex_{i+1}=3$で変わらない。

上記のことから部分数列内にどの数字がいくつ存在するかを管理する必要がある。今回は配列`cont`が該当する。また、`cont`の大きさは制約条件をもとに定義した。

比較の話をしたせいで忘れていたが$mex_0$については初期の部分数列を`cont`に入力後に小さいほうから、値を見ていき、最初に値が0となるインデックス番号が初期の$mex_0$に該当するのでそれを代入した。

コードは以下の通り
```python
#入力
n,m= list(map(int, input().split()))
a= list(map(int, input().split()))
#部分数列の値管理用
cont=[0]*(n)
#最初の部分数列の値別の個数
for i in range(m):
    cont[a[i]]+=1
#仮の解
o=n
#1つ目の部分数列のmexの計算
for i in range(n):
    if cont[i]==0:
        o=i
        break
#2つ目以降の部分数列
for i in range(n-m):
    #次に削除する部分数列の要素
    am_pop=a[i]
    #次に追加する部分数列の要素
    am_append=a[m+i]
    #部分数列の値別の個数の修正
    cont[am_pop]-=1
    cont[am_append]+=1
    #今回削除した要素についてのみ確認
    if cont[am_pop]==0:
        o=min(o,am_pop)
print(o)
```
## おまけ
余談だが今回の問題で登場した$mex$はグラフ理論とかで使われているらしい。

英語版だけwikipediaが存在したのでリンクを貼っておきます。興味あればぜひ。

<a href="https://en.wikipedia.org/wiki/Mex_(mathematics)">リンク</a>
